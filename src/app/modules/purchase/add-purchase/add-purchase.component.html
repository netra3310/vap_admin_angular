<!-- <app-loading [status]="IsSpinner"></app-loading> -->
<div>
    <div class="mb-5 text-end">
        <span *ngIf="!btnAddDisabled">
            <!--begin::Primary button-->
            <a *ngxPermissionsOnly="PurchasePermission.AddPurchase" 
                class="btn btn-sm fw-bold btn-primary ms-2"
                (click)="savePurchase()">
                <span>Add Purchase</span>
            </a> 
            <!--end::Primary button-->
            
            <!--begin::Primary button-->
            <a *ngxPermissionsOnly="PurchasePermission.AddHoldPurchase"
                (click)="saveOpenPurchase()" class="btn btn-sm fw-bold btn-success ms-2">
                <span>Add Hold Purchase</span>
            </a> 
            <!--end::Primary button-->
        </span>
        <!--begin::Primary button-->
        <a *ngxPermissionsOnly="PurchasePermission.PurchaseListing" 
            routerLink="/purchase/purchase-order-report"
            class="btn btn-sm fw-bold btn-secondary ms-2">
            <span title="Close">Close</span>
        </a> 
        <!--end::Primary button-->
        <app-session-time-counter class="ms-20"> </app-session-time-counter>
    </div>
</div>

<!--begin::Content-->
    <!--begin::Content container-->
    <div class="app-container ">
        <!--begin::Form-->
        <form id="kt_ecommerce_edit_order_form" class="form d-flex flex-column flex-lg-row" data-kt-redirect="../../demo1/dist/apps/ecommerce/sales/listing.html">
            <!--begin::Aside column-->
            <div class="w-100 flex-lg-row-auto w-lg-300px mb-7 me-7 me-lg-10">
                <!--begin::Order details-->
                <div class="card card-flush py-4">
                    <!--begin::Card header-->
                    <div class="card-header">
                        <div class="card-title">
                            <h2>Order Details</h2>
                        </div>
                    </div>
                    <!--end::Card header-->
                    <!--begin::Card body-->
                    <div class="card-body pt-0">
                        <div class="d-flex flex-column gap-10">
                            
                            <div class="separator"></div>

                            <!--begin::Input group-->
                            <div class="fv-row">
                                <div class="card-title">
                                    <h4 translate="ADDPURCHASE.ORDERBY"></h4>
                                </div>
                                <span class="svg-icon svg-icon-1 me-1">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20 14H18V10H20C20.6 10 21 10.4 21 11V13C21 13.6 20.6 14 20 14ZM21 19V17C21 16.4 20.6 16 20 16H18V20H20C20.6 20 21 19.6 21 19ZM21 7V5C21 4.4 20.6 4 20 4H18V8H20C20.6 8 21 7.6 21 7Z" fill="currentColor" />
                                        <path opacity="0.3" d="M17 22H3C2.4 22 2 21.6 2 21V3C2 2.4 2.4 2 3 2H17C17.6 2 18 2.4 18 3V21C18 21.6 17.6 22 17 22ZM10 7C8.9 7 8 7.9 8 9C8 10.1 8.9 11 10 11C11.1 11 12 10.1 12 9C12 7.9 11.1 7 10 7ZM13.3 16C14 16 14.5 15.3 14.3 14.7C13.7 13.2 12 12 10.1 12C8.10001 12 6.49999 13.1 5.89999 14.7C5.59999 15.3 6.19999 16 7.39999 16H13.3Z" fill="currentColor" />
                                    </svg>
                                </span>
                                <!--begin::Label-->
                                <label class="required form-label">Supplier</label>
                                <!--end::Label-->
                                <app-custom-select
                                    [items]="filteredOrderBy" [virtualScroll]="true" bindLabel="label"
                                    [(twBinding)]="addPurchase.supplier" [searchFn]="dataFunc"
                                    (onChange)="BindDeliveryAddress($event)"
                                    [placeholder]="'Select Supplier...'">
                                </app-custom-select>
                                <!--begin::Description-->
                                <!-- <div class="text-muted fs-7">Assign a template from your current theme to define how the category products are displayed.</div> -->
                                <!-- <div class="mb-2 color-light" [ngClass]="{'d-none': supplierName == ''}">
                                    <label for="name">{{supplierName}}</label> <br>
                                    <label for="phon">{{orderByContact}}</label>
                                    <br>
                                    <label for="address"> {{supplierAddress}}</label>
                                </div> -->
                                <!--end::Description-->
                                <!--begin::Description-->
                                <!-- <div class="text-muted fs-7">Assign a template from your current theme to define how the category products are displayed.</div> -->
                                <div class="mb-2 color-light btn btn-outline btn-outline-dashed w-100 text-start" [ngClass]="{'d-none': supplierName == ''}">
                                    <label for="name">
                                        <span [inlineSVG]="'./assets/media/icons/duotune/communication/com006.svg'"
                                            class="svg-icon svg-icon-1 me-1"
                                        ></span>
                                        <span class="badge-light-primary">
                                            {{supplierName}}
                                        </span>
                                    </label> 
                                    <br>
                                    <label for="phon">
                                        <span [inlineSVG]="'./assets/media/icons/duotune/electronics/elc007.svg'"
                                            class="svg-icon svg-icon-1 me-1"
                                        ></span>
                                        <span class="badge-light-success">
                                            {{orderByContact}}
                                        </span>
                                    </label>
                                    <label for="phon">
                                        <span [inlineSVG]="'./assets/media/icons/duotune/maps/map008.svg'"
                                        class="svg-icon svg-icon-1 me-1"
                                        ></span>
                                        <span class="badge-light-primary">
                                            {{supplierAddress}}
                                        </span>
                                    </label>
                                </div>
                                <!--end::Description-->
                                <!-- <app-custom-radio
                                    [name]="'groupname'"
                                    [value]="'Cash'"
                                    [(twBinding)]="addPurchase.type"
                                    [inputId]="'type1'"
                                >
                                </app-custom-radio>
                                <label
                                    class="form-check-label ps-2 ms-2 me-4"
                                    for="type1"
                                >Cash</label>
                                <app-custom-radio
                                    [name]="'groupname'"
                                    [value]="'Credit'"
                                    [(twBinding)]="addPurchase.type"
                                    [inputId]="'type2'">
                                </app-custom-radio>
                                <label
                                    class="form-check-label ps-2 ms-2 me-4"
                                    for="type2"
                                >Credit</label> -->
                                 <!--begin::Row-->
                                <div class="row row-cols-1 row-cols-md-3 row-cols-lg-1 row-cols-xl-2 g-9 mt-1" data-kt-buttons="true" data-kt-buttons-target="[data-kt-button='true']">
                                    <!--begin::Col-->
                                    <div class="col mt-0">
                                        <!--begin::Option-->
                                        <label class="btn btn-outline btn-outline-dashed btn-active-light-primary d-flex text-start p-3" data-kt-button="true" [ngClass]="{'active': addPurchase.type === 'Cash'}">
                                            <!--begin::Radio-->
                                            <span class="form-check form-check-custom form-check-solid form-check-sm align-items-start mt-1">
                                                <!-- <input class="form-check-input" type="radio" name="groupname" value="Cash" checked="checked" /> -->
                                                <app-custom-radio
                                                    [name]="'groupname'"
                                                    [value]="'Cash'"
                                                    [(twBinding)]="addPurchase.type"
                                                    [inputId]="'type1'"
                                                >
                                                </app-custom-radio>
                                            </span>
                                            <!--end::Radio-->
                                            <!--begin::Info-->
                                            <span class="ms-5">
                                                <span class="fs-4 fw-bold text-gray-800 d-block">Cash</span>
                                            </span>
                                            <!--end::Info-->
                                        </label>
                                        <!--end::Option-->
                                    </div>
                                    <!--end::Col-->
                                    <!--begin::Col-->
                                    <div class="col mt-0">
                                        <!--begin::Option-->
                                        <label class="btn btn-outline btn-outline-dashed btn-active-light-primary d-flex text-start p-3" data-kt-button="true" [ngClass]="{'active': addPurchase.type === 'Credit'}">
                                            <!--begin::Radio-->
                                            <span class="form-check form-check-custom form-check-solid form-check-sm align-items-start mt-1">
                                                <app-custom-radio
                                                    [name]="'groupname'"
                                                    [value]="'Credit'"
                                                    [(twBinding)]="addPurchase.type"
                                                    [inputId]="'type2'"
                                                >
                                                </app-custom-radio>
                                                <!-- <input class="form-check-input" type="radio" name="discount_option" value="2" /> -->
                                            </span>
                                            <!--end::Radio-->
                                            <!--begin::Info-->
                                            <span class="ms-5">
                                                <span class="fs-4 fw-bold text-gray-800 d-block">Credit</span>
                                            </span>
                                            <!--end::Info-->
                                        </label>
                                        <!--end::Option-->
                                    </div>
                                    <!--end::Col-->
                                </div>
                                <!--end::Row-->
                                <!--begin::Item-->
                                <div class="btn btn-outline btn-outline-dashed fv-row w-100 mt-3 text-start justify-content-center d-flex" *ngIf="addPurchase.type == 'Cash'">
                                    <a  class="btn btn-sm fw-bold btn-primary ms-2"
                                        (click)="openModalPaymentPassword()">
                                        <span class="svg-icon svg-icon-3 svg-icon-primary">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-fill-lock" viewBox="0 0 16 16">
                                                <path d="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm-9 8c0 1 1 1 1 1h5v-1a1.9 1.9 0 0 1 .01-.2 4.49 4.49 0 0 1 1.534-3.693C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4Zm7 0a1 1 0 0 1 1-1v-1a2 2 0 1 1 4 0v1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-2Zm3-3a1 1 0 0 0-1 1v1h2v-1a1 1 0 0 0-1-1Z"/>
                                            </svg>
                                        </span>
                                        <span translate="REPORTS.PAYMENT"></span>
                                    </a> 
                                    
                                </div>
                                <!--end::Item-->
                            </div>
                            <!--end::Input group-->
                            
                            <div class="separator"></div>

                            <!--begin::Input group-->
                            <div class="fv-row">
                                <div class="card-title">
                                    <h4>Out Let</h4>
                                </div>
                                <!--begin::Label-->
                                
                                <label class="required form-label">
                                    <span class="svg-icon svg-icon-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shop" viewBox="0 0 16 16">
                                            <path d="M2.97 1.35A1 1 0 0 1 3.73 1h8.54a1 1 0 0 1 .76.35l2.609 3.044A1.5 1.5 0 0 1 16 5.37v.255a2.375 2.375 0 0 1-4.25 1.458A2.371 2.371 0 0 1 9.875 8 2.37 2.37 0 0 1 8 7.083 2.37 2.37 0 0 1 6.125 8a2.37 2.37 0 0 1-1.875-.917A2.375 2.375 0 0 1 0 5.625V5.37a1.5 1.5 0 0 1 .361-.976l2.61-3.045zm1.78 4.275a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 1 0 2.75 0V5.37a.5.5 0 0 0-.12-.325L12.27 2H3.73L1.12 5.045A.5.5 0 0 0 1 5.37v.255a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0zM1.5 8.5A.5.5 0 0 1 2 9v6h1v-5a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v5h6V9a.5.5 0 0 1 1 0v6h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1V9a.5.5 0 0 1 .5-.5zM4 15h3v-5H4v5zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3zm3 0h-2v3h2v-3z"/>
                                        </svg>
                                    </span>
                                    Out Let</label>
                                <!--end::Label-->
                                <!--begin::Select2-->
                                <app-custom-dropdown
                                    [options]="OutletData" placeholder="Select a Outlet" (onChange)="change($event)"
                                    [showClear]="true" [(twBinding)]="outletID" required optionLabel="Name">
                                </app-custom-dropdown>
                                <!--end::Select2-->
                                <label class="form-label">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill svg-icon svg-icon-1 me-1" viewBox="0 0 16 16">
                                        <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"/>
                                    </svg>
                                    Remarks
                                </label>
                                <!-- <input class="form-control" type="text" id="remarks" value={{addPurchase.remarks}} (onChange)="onChangeRemarks($event)"/> -->
                                <input class="form-control" pInputText type="text" id="remarks" [value]="addPurchase.remarks" (change)="onChangeRemarks($event)">
                            </div>
                            <!--end::Input group-->
                            
                            <div class="separator"></div>

                            <!--begin::Input group-->
                            <div class="fv-row">
                                <div class="card-title">
                                    <h4>Date Section</h4>
                                </div>
                                <!--begin::Label-->
                                <label class="required form-label">
                                    <span [inlineSVG]="'./assets/media/icons/duotune/general/gen014.svg'"
                                        class="svg-icon svg-icon-1 me-1"
                                    ></span>
                                    Receipt Date
                                </label>
                                <!--end::Label-->
                                <!--begin::Editor-->
                                <app-custom-date-picker [(twBinding)]="addPurchase.receiptDate" [showIcon]="true" inputId="icon"></app-custom-date-picker>
                                <!--end::Editor-->

                                <!--begin::Label-->
                                <label class="required form-label">
                                    <span [inlineSVG]="'./assets/media/icons/duotune/general/gen014.svg'"
                                        class="svg-icon svg-icon-1 me-1"
                                    ></span>
                                    Order Date
                                </label>
                                <!--end::Label-->
                                <!--begin::Editor-->
                                <app-custom-date-picker [(twBinding)]="addPurchase.orderDate" [showIcon]="true" inputId="icon"></app-custom-date-picker>
                                <!--end::Editor-->
                            </div>
                            <!--end::Input group-->
                            
                            <div class="separator"></div>

                            <!--begin::Input group-->
                            <div class="fv-row">
                                <div class="card-title">
                                    <h4>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-cart4 svg-icon svg-icon-1 me-1" viewBox="0 0 16 16">
                                            <path d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5zM3.14 5l.5 2H5V5H3.14zM6 5v2h2V5H6zm3 0v2h2V5H9zm3 0v2h1.36l.5-2H12zm1.11 3H12v2h.61l.5-2zM11 8H9v2h2V8zM8 8H6v2h2V8zM5 8H3.89l.5 2H5V8zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0z"/>
                                        </svg>
                                        Cart Summary
                                    </h4>
                                </div>
                                <!--begin::Label-->
                                <!-- <label class="required form-label">Receipt Date</label> -->
                                <!--end::Label-->
                                <!--begin::Container-->
                                <div class="d-flex justify-content-start">
                                    <!--begin::Section-->
                                    <div class="mw-300px">
                                        <!--begin::Item-->
                                        <div class="d-flex flex-stack mb-3">
                                            <!--begin::Accountname-->
                                            <div class="fw-semibold pe-10 text-gray-600 fs-7">Subtotal:</div>
                                            <!--end::Accountname-->
                                            <!--begin::Label-->
                                            <div class="text-end fw-bold fs-6 text-gray-800">{{subTotal | number:'1.2-2' }}</div>
                                            <!--end::Label-->
                                        </div>
                                        <!--end::Item-->
                                        <!--begin::Item-->
                                        <div class="d-flex flex-stack mb-3">
                                            <!--begin::Accountname-->
                                            <div class="fw-semibold pe-10 text-gray-600 fs-7">Total Discount</div>
                                            <!--end::Accountname-->
                                            <!--begin::Label-->
                                            <div class="text-end fw-bold fs-6 text-gray-800">{{totalDiscount | number:'1.2-2' }}</div>
                                            <!--end::Label-->
                                        </div>
                                        <!--end::Item-->
                                        <!--begin::Item-->
                                        <div class="d-flex flex-stack mb-3">
                                            <!--begin::Accountnumber-->
                                            <div class="fw-semibold pe-10 text-gray-600 fs-7">Grand Total</div>
                                            <!--end::Accountnumber-->
                                            <!--begin::Number-->
                                            <div class="text-end fw-bold fs-6 text-gray-800">{{grandTotal | number:'1.2-2' }}</div>
                                            <!--end::Number-->
                                        </div>
                                        <!--end::Item-->
                                    </div>
                                    <!--end::Section-->
                                </div>
                                <!--end::Container-->
                            </div>
                            <!--end::Input group-->
                            <div class="separator"></div>
                            <!--begin::Item-->
                            <div class=" fv-row" *ngIf="false">

                                <label class="form-label">Add Payment</label>
                                <app-custom-input
                                    [type]="'number'"  [(twBinding)]="addPurchase.payment"
                                    [classGroup]="'form-control'"
                                >
                                </app-custom-input>

                                <label class="form-label">Password</label>
                                <app-custom-input
                                    [type]="'password'" [(twBinding)]="addPurchase.password"
                                    [classGroup]="'form-control '"
                                >
                                </app-custom-input>
                                <!--begin::Filter-->
                                <div class="d-flex flex-stack justify-content-end mt-6">
                                    <button type="button" class="btn btn-sm btn-flex btn-light-primary"
                                        (click)="savePurchase()" *ngIf="!btnAddDisabled">
                                        <!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
                                        <span class="svg-icon svg-icon-3">
                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="5" fill="currentColor" />
                                                <rect x="10.8891" y="17.8033" width="12" height="2" rx="1" transform="rotate(-90 10.8891 17.8033)" fill="currentColor" />
                                                <rect x="6.01041" y="10.9247" width="12" height="2" rx="1" fill="currentColor" />
                                            </svg>
                                        </span>
                                        <!--end::Svg Icon-->Add payment
                                    </button>
                                </div>
                                <!--end::Filter-->
                            </div>
                            <!--end::Item-->
                        </div>
                    </div>
                    <!--end::Card header-->
                </div>
                <!--end::Order details-->
            </div>
            <!--end::Aside column-->
            <!--begin::Main column-->
            <div class="d-flex flex-column flex-lg-row-fluid gap-7 gap-lg-10">
                <!--begin::Order details-->
                <div class="card card-flush py-4">
                    <!--begin::Card header-->
                    <div class="card-header">
                        <div class="card-title">
                            <h2>Select Products</h2>
                        </div>
                    </div>
                    <!--end::Card header-->
                    <!--begin::Card body-->
                    <div class="card-body pt-0">
                        <div class="d-flex flex-column gap-10">
                            <!--begin::Input group-->
                            <div>
                                <!--begin::Label-->
                                <label class="form-label">Add products to this order</label>
                                <!--end::Label-->
                                <!--begin::Selected products-->
                                <div class="row row-cols-1 row-cols-xl-3 row-cols-md-2 border border-dashed rounded pt-3 pb-1 px-2 mb-5 mh-500px overflow-scroll" >
                                    
                                    <!-- begin::Body -->
                                    <div class="card-body py-3">
                                        <!-- begin::Table container -->
                                        <div class="table-responsive">
                                        <!-- begin::Table -->
                                        <table class="table align-middle gs-0 gy-4">
                                            <!-- begin::Table head -->
                                            <thead>
                                                <tr class="fw-bolder text-muted bg-light">
                                                    <th class="ps-4 rounded-start" style="width: 70px">Action</th>  <!-- style="width: 80px" -->
                                                    <th class="product-width">Product</th>
                                                    <th>Quantity</th>  <!-- style="width: 90px" -->
                                                    <!-- <th style="width: 90px">UOM</th> -->
                                                    <th >Unit Price</th><!--  style="width: 80px" -->
                                                    <th>Software Sale Price</th>
                                                    <th>Web-shop Sale Price</th>
                                                    <th>Discount(%)</th>
                                                    <th>Discount</th>
                                                    <th class="rounded-end">Net Price</th>
                                                </tr>
                                            </thead>
                                            <!-- end::Table head -->
                                            <!-- begin::Table body -->
                                            <tbody>
                                                <ng-container *ngFor="let product of products; let ri = index">
                                                    <tr>
                                                        <td>
                                                            <button *ngIf="product.IsTrackable" pRipple type="button" (click)="OpenProductTrackables(ri)"
                                                                icon="pi pi-times" class="btn btn-sm btn-flex btn-light-primary d-flex m-auto">
                                                                <span class="svg-icon svg-icon-3 m-0">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-door-open" viewBox="0 0 16 16">
                                                                        <path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1z"/>
                                                                        <path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117zM11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5zM4 1.934V15h6V1.077l-6 .857z"/>
                                                                    </svg>
                                                                </span>
                                                            </button>
                                                            <button pButton pRipple type="button" (click)="deleteItemFromProductArr(product)"
                                                                icon="pi pi-times" class="btn btn-sm btn-flex btn-light-danger d-flex m-auto">
                                                                <!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
                                                                <span class="svg-icon svg-icon-3 m-0">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square" viewBox="0 0 16 16">
                                                                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                                                                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                                                                    </svg>
                                                                </span>
                                                                <!--end::Svg Icon-->
                                                            </button>
                                                        </td>
                                                        <td>
                                                            <div class="d-flex align-items-center">
                                                                <div class="symbol symbol-50px me-5">
                                                                <!-- <img
                                                                    src="./assets/media/stock/600x400/img-3.jpg"
                                                                    class=""
                                                                    alt=""
                                                                /> -->
                                                                </div>
                                                                <div class="d-flex justify-content-start flex-column">
                                                                <a class="text-dark fw-bolder text-hover-primary mb-1 fs-6 me-5">
                                                                    {{product.selectedProduct.label}}
                                                                </a>
                                                                </div>
                                                                <span class="badge badge-light-warning fs-1" (click)="OpenProductLocations(product)">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                                                                        <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                                                                    </svg>
                                                                </span>
                                                            </div>
                                                            <!-- {{OnChangeText(product)}} -->
                                                        </td>
                                                        <td>
                                                            <!-- <input pInputText type="number" *ngIf="!product.IsTrackable" [(ngModel)]="product.Quantity"
                                                                (blur)="OnChangeText(product)" [disabled]="product.IsQtyDisable" /> -->
                                                            <app-custom-input
                                                                [type]="'number'" *ngIf="!product.IsTrackable" [(twBinding)]="product.Quantity"
                                                                (blur)="OnChangeText(product)" [isDisabled]="product.IsQtyDisable"
                                                                [classGroup]="'form-control form-control-white form-control-sm w-80px ps-3'"
                                                            >
                                                            </app-custom-input>
                                                            <label *ngIf="product.IsTrackable">{{product.TrackableCodes.length}}</label>
                                                        </td>
                                                        <td>
                                                            <app-custom-input pInputText [type]="'number'" [(twBinding)]="product.Price" 
                                                                (blur)="OnChangeText(product)" (change)="changePrice(product)"
                                                                [classGroup]="'form-control form-control-white form-control-sm w-80px ps-3'">
                                                            </app-custom-input>
                                                        </td>
                                                        <td>
                                                            <app-custom-input pInputText [type]="'number'" [(twBinding)]="product.SalePrice" 
                                                                (blur)="OnChangeText(product)"
                                                                [classGroup]="'form-control form-control-white form-control-sm w-80px ps-3'">
                                                            </app-custom-input>
                                                        </td>
                                                        <td>
                                                            <app-custom-input pInputText [type]="'number'" [isDisabled]="!product.disabledShopSalePrice"  
                                                                [(twBinding)]="product.ShopSalePrice" (blur)="OnChangeText(product)"
                                                                [classGroup]="'form-control form-control-white form-control-sm w-80px ps-3'">
                                                            </app-custom-input>
                                                        </td>
                                                        <td>
                                                            <app-custom-input pInputText [type]="'number'" [(twBinding)]="product.DiscPer" 
                                                                (blur)="OnChangeText(product)" [classGroup]="'form-control form-control-white form-control-sm w-80px ps-3'"
                                                            >
                                                            </app-custom-input>
                                                        </td>
                                                        <td>
                                                            <app-custom-input pInputText [type]="'text'" [(twBinding)]="product.DiscVal" 
                                                                [isDisabled]="true" [classGroup]="'form-control form-control-white form-control-sm w-80px ps-3'"
                                                            >
                                                            </app-custom-input>
                                                        </td>
                                                        <td class="">
                                                            <app-custom-input pInputText [type]="'text'" [(twBinding)]="product.NetPrice" 
                                                                [isDisabled]="true"
                                                                [classGroup]="'form-control form-control-white form-control-sm w-80px ps-3'"
                                                                >
                                                            </app-custom-input>

                                                            <!-- <input class="form-control form-control-white form-control-sm w-80px ps-3" type="text" disabled
                                                                [(ngModel)]="product.NetPrice" /> -->
                                                        </td>
                                                    </tr>
                                                </ng-container>
                                            </tbody>
                                            <!-- end::Table body -->
                                        </table>
                                        <!-- end::Table -->
                                        </div>
                                        <!-- end::Table container -->
                                    </div>
                                    <!-- begin::Body -->
                                </div>
                                <!--begin::Selected products-->
                            </div>
                            <!--end::Input group-->
                            <!--begin::Separator-->
                            <div class="separator"></div>
                            <!--end::Separator-->
                            <app-genric-table (emitRowClick)="selectValue($event)" [menuItems]="[]" 
                                [data]="ProductData" [columnsData]="productsColumn" [initialColumns]="initialProductsColumns" 
                                [totalRecords]="ProductData.length" [enablePrint]="false" [loadingData]="isLoadingProducts">
                            </app-genric-table>
                            
                        </div>
                    </div>
                    <!--end::Card header-->
                </div>
                <!--end::Order details-->
            </div>
            <!--end::Main column-->
        </form>
        <!--end::Form-->
    </div>
    <!--end::Content container-->
<!--end::Content-->

<app-generic-modal #locationModal [modalConfig]="locationModalConfig">
    <div class="row">
        <div class="col-5">
            <div class="row row-cols-1 row-cols-md-2 mb-6 mb-xl-9">
                <div class="col">
                    <!--begin::Card-->
                    <div class="card pt-4 h-md-100 mb-6 mb-md-0">
                        <!--begin::Card header-->
                        <div class="card-header border-0">
                            <!--begin::Card title-->
                            <div class="card-title">
                                <h2 class="fw-bold">Type</h2>
                            </div>
                            <!--end::Card title-->
                        </div>
                        <!--end::Card header-->
                        <!--begin::Card body-->
                        <div class="card-body pt-0">
                            <div class="fw-bold fs-2">
                                <div class="d-flex">
                                    <div class="ms-2">
                                        <span class="text-muted fs-4 fw-semibold">Selected Quantity is {{selectedRowForDialogs?.Quantity ? selectedRowForDialogs.Quantity : ""}}</span>
                                    </div>
                                </div>
                            </div>
                            <app-custom-radio
                                [name]="'groupname'"
                                [value]="'OldAssigned'"
                                [(twBinding)]="LocationType"
                                [inputId]="'LocationType1'"
                                (onClick)="LocationChange()"
                            >
                            </app-custom-radio>
                            <label
                                class="form-check-label ps-2 ms-2 me-4"
                                for="LocationType1"
                            >Old Assigned</label>
                            <br />
                            <br />
                            <app-custom-radio
                                [name]="'groupname'"
                                [value]="'ScanQR'"
                                [(twBinding)]="LocationType"
                                [inputId]="'LocationType2'"
                                (onClick)="LocationChange()"
                                >
                            </app-custom-radio>
                            <label
                                class="form-check-label ps-2 ms-2 me-4"
                                for="LocationType2"
                            >Scan QR</label>
                        </div>
                        <!--end::Card body-->
                    </div>
                    <!--end::Card-->
                </div>
                <div class="col">
                    <!--begin::Card-->
                    <div class="card pt-4 h-md-100 mb-6 mb-md-0">
                        <!--begin::Card header-->
                        <div class="card-header border-0">
                            <!--begin::Card title-->
                            <div class="card-title">
                                <h2 class="fw-bold">Location Insertion</h2>
                            </div>
                            <!--end::Card title-->
                        </div>
                        <!--end::Card header-->
                        <!--begin::Card body-->
                        <div class="card-body pt-0">
                            <label for="Loc" class="form-label">Select Location</label>
                            <!-- <app-custom-input
                                id="Qty"
                                [type]="'text'"  [(twBinding)]="SelectedLocObj.Location"
                                [classGroup]="'form-control'"
                            >
                            </app-custom-input> -->
                            <input class="form-control" id="Loc" type="text" pInputText [(ngModel)]="SelectedLocObj.Location">
                            <label for="Qty" class="form-label mt-3">Select Quantity</label>
                            <!-- <app-custom-input
                                id="Loc"
                                [type]="'number'"  [(twBinding)]="SelectedLocObj.Quantity"
                                [classGroup]="'form-control'"
                            >
                            </app-custom-input> -->
                            <input class="form-control" id="Qty" type="number" pInputText [(ngModel)]="SelectedLocObj.Quantity">
                            <button type="button" class="btn btn-sm btn-flex btn-light-primary mt-5"
                                (click)="AddLocationObject()">
                                <!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
                                <span class="svg-icon svg-icon-3">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="5" fill="currentColor" />
                                        <rect x="10.8891" y="17.8033" width="12" height="2" rx="1" transform="rotate(-90 10.8891 17.8033)" fill="currentColor" />
                                        <rect x="6.01041" y="10.9247" width="12" height="2" rx="1" fill="currentColor" />
                                    </svg>
                                </span>
                                <!--end::Svg Icon-->Add
                            </button>
                        </div>
                        <!--end::Card body-->
                    </div>
                    <!--end::Card-->
                </div>
            </div>
            <!--begin::Card-->
            <div class="card pt-4 mb-6 mb-xl-9">
                <!--begin::Card header-->
                <div class="card-header border-0">
                    <!--begin::Card title-->
                    <div class="card-title">
                        <h2>Data Section</h2>
                    </div>
                    <!--end::Card title-->
                </div>
                <!--end::Card header-->
                <!--begin::Card body-->
                <div class="card-body pt-0 pb-5 overflow-auto" *ngIf="LocationType=='OldAssigned'">
                    <!--begin::Table-->
                    <table class="table align-middle table-row-dashed gy-5" id="kt_table_customers_payment">
                        <!--begin::Table head-->
                        <thead class="border-bottom border-gray-200 fs-7 fw-bold">
                            <!--begin::Table row-->
                            <tr class="text-start text-muted text-uppercase gs-0">
                                <th class="min-w-100px">Location</th>
                                <th>Assigned Quantity</th>
                                <th>Action</th>
                            </tr>
                            <!--end::Table row-->
                        </thead>
                        <!--end::Table head-->
                        <!--begin::Table body-->
                        <tbody class="fs-6 fw-semibold text-gray-600">
                            <ng-container *ngFor="let item of OldAssignedList">
                                <!--begin::Table row-->
                                <tr>
                                    <!--begin::Status=-->
                                    <td>
                                        <span class="badge badge-light-success">{{item.Location}}</span>
                                    </td>
                                    <!--end::Status=-->
                                    <!--begin::Status=-->
                                    <td>
                                        <span class="badge badge-light-success">{{item.Quantity}}</span>
                                    </td>
                                    <!--end::Status=-->
                                    <td> 
                                        <button type="button" class="btn btn-sm btn-flex btn-light-primary"
                                            (click)="SelectOldAssignedRowOrderBy(item)">
                                            <!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
                                            <span class="svg-icon svg-icon-3">
                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="5" fill="currentColor" />
                                                    <rect x="10.8891" y="17.8033" width="12" height="2" rx="1" transform="rotate(-90 10.8891 17.8033)" fill="currentColor" />
                                                    <rect x="6.01041" y="10.9247" width="12" height="2" rx="1" fill="currentColor" />
                                                </svg>
                                            </span>
                                            <!--end::Svg Icon-->
                                        </button>
                                    </td>
                                </tr>
                                <!--end::Table row-->
                            </ng-container>
                        </tbody>
                        <!--end::Table body-->
                    </table>
                    <!--end::Table-->
                </div>
                <!--end::Card body-->
                <div class="card-body pt-0 pb-5 overflow-auto">
                    <span *ngIf="LocationType=='ScanQR'">
                        <div class="p-field p-col">
                            <label for="QRScanner" class="form-label">Select and Scan</label>
                            <app-custom-input
                                id="QRScanner"
                                [type]="'text'" [(twBinding)]="QRScanner"
                                [classGroup]="'form-control'"
                            >
                            </app-custom-input>
                        </div>
                        <div class="p-field p-col mt-5">
                            <button type="button" class="btn btn-sm btn-flex btn-light-primary"
                                (click)="OnLocationChange()">
                                <!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
                                <span class="svg-icon svg-icon-3 m-0">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="5" fill="currentColor" />
                                        <rect x="10.8891" y="17.8033" width="12" height="2" rx="1" transform="rotate(-90 10.8891 17.8033)" fill="currentColor" />
                                        <rect x="6.01041" y="10.9247" width="12" height="2" rx="1" fill="currentColor" />
                                    </svg>
                                </span>
                                <!--end::Svg Icon-->Select
                            </button>
                        </div>
                        
                    </span>
                </div>
            </div>
        </div>
        <div class="col-7">
            <div class="card pt-4 mb-6 mb-xl-9">
                <!--begin::Card header-->
                <div class="card-header border-0">
                    <!--begin::Card title-->
                    <div class="card-title">
                        <h2>Selected Locations</h2>
                    </div>
                    <!--end::Card title-->
                </div>
                <!--end::Card header-->
                <!--begin::Card body-->
                <div class="card-body pt-0 pb-5 overflow-auto">
                    <!--begin::Table-->
                    <table class="table align-middle table-row-dashed gy-5" id="kt_table_customers_payment">
                        <!--begin::Table head-->
                        <thead class="border-bottom border-gray-200 fs-7 fw-bold">
                            <!--begin::Table row-->
                            <tr class="text-start text-muted text-uppercase gs-0">
                                <th class="min-w-100px">Location</th>
                                <th>Assigned Quantity</th>
                                <th>Action</th>
                            </tr>
                            <!--end::Table row-->
                        </thead>
                        <!--end::Table head-->
                        <!--begin::Table body-->
                        <tbody class="fs-6 fw-semibold text-gray-600">
                            <ng-container *ngFor="let item of SelectedLocationList">
                                <!--begin::Table row-->
                                <tr>
                                    <!--begin::Status=-->
                                    <td>
                                        <span class="badge badge-light-success">{{item.Location}}</span>
                                    </td>
                                    <!--end::Status=-->
                                    <!--begin::Status=-->
                                    <td>
                                        <span class="badge badge-light-success">{{item.Quantity}}</span>
                                    </td>
                                    <!--end::Status=-->
                                    <td> 
                                        <button type="button" class="btn btn-sm btn-flex btn-light-primary"
                                            (click)="removeSelectedRow(item)">
                                            <!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
                                            <span class="svg-icon svg-icon-3">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark-x-fill" viewBox="0 0 16 16">
                                                    <path fill-rule="evenodd" d="M2 15.5V2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.74.439L8 13.069l-5.26 2.87A.5.5 0 0 1 2 15.5zM6.854 5.146a.5.5 0 1 0-.708.708L7.293 7 6.146 8.146a.5.5 0 1 0 .708.708L8 7.707l1.146 1.147a.5.5 0 1 0 .708-.708L8.707 7l1.147-1.146a.5.5 0 0 0-.708-.708L8 6.293 6.854 5.146z"/>
                                                </svg>
                                            </span>
                                            <!--end::Svg Icon-->
                                        </button>
                                    </td>
                                </tr>
                                <!--end::Table row-->
                            </ng-container>
                        </tbody>
                        <!--end::Table body-->
                    </table>
                    <!--end::Table-->
                </div>
                <!--end::Card body-->
            </div>
        </div>
    </div>
</app-generic-modal>

<app-generic-modal #modalPaymentPassword [modalConfig]="modalPaymentPasswordConfig" (afterOpen)="focusPaymentPassword()">
    <label class="form-label" for="order_amount">
                            
        <span [inlineSVG]="'./assets/media/icons/duotune/finance/fin007.svg'"
            class="svg-icon svg-icon-1 me-1"
        ></span>
        <span translate="Amount">
        </span>
    </label>
    <app-custom-input 
        [type]="'number'"  [(twBinding)]="addPurchase.payment"
        [classGroup]="'form-control mb-5'"
        id="order_amount" name="order_amount"
    >
    </app-custom-input>
    <label for="phon">
        <span class="svg-icon svg-icon-1 me-1" >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-key" viewBox="0 0 16 16">
                <path d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z"/>
                <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
            </svg>
        </span>
        <span class="form-label">
            password
        </span>
    </label>
    <app-custom-input #input_payment_password
        [type]="'password'" [(twBinding)]="addPurchase.password"
        [classGroup]="'form-control '"
    >
    </app-custom-input>
    <!--begin::Filter-->
    <div class="d-flex flex-stack justify-content-end mt-6">
        <button type="button" class="btn btn-sm btn-flex btn-light-primary"
            (click)="savePurchase()" >
            <!--begin::Svg Icon | path: icons/duotune/general/gen035.svg-->
            <span class="svg-icon svg-icon-3">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="5" fill="currentColor" />
                    <rect x="10.8891" y="17.8033" width="12" height="2" rx="1" transform="rotate(-90 10.8891 17.8033)" fill="currentColor" />
                    <rect x="6.01041" y="10.9247" width="12" height="2" rx="1" fill="currentColor" />
                </svg>
            </span>
            <!--end::Svg Icon-->
            <span>Save</span>
        </button>
    </div>
    <!--end::Filter-->
</app-generic-modal>