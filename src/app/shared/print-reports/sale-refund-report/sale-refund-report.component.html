<div id="printA4-sale-refund" [hidden]="true" style="width: 95%;margin:0 auto;" *ngIf="SaleDetails">
  <div style="width: 93%; margin: auto;">
    <div style="width: 100%;display: table;">
      <!-- <div style="width: 100%;">
        <div style="float: left; margin: 10px 36px;">
          <img src="https://emcparts.shop/image/cache/webp/catalog/logos/emc-logo-new-123x60-123x60.png" alt="*"
            style="width: 120px;display: block;margin: auto;">
        </div>
        <div style="float: right;;">
          <h3 style="font-family: Georgia, 'Times New Roman', Times, serif;margin: 28px 30px 0px 0px; font-size: 30px;">Sale Refund Report</h3>
        </div>
      </div> -->
      <!-- <br>
      <hr style="border-top: solid #d3d4d5; border-width: 3px 0 0 0; margin: 1rem 0;margin: 65px 15px 0 15px"> -->

      <div style="width: 100%;display: table;">
        <div style="width: 53%;float: left;">

          <div style="padding:10px 5px;display: table;">
            <h4 style="font-family: sans-serif !important;color: #8d9092; margin: 5px 30px 0px 0px; font-size: 30px;">
              Sale Refund Report</h4>
            <!-- <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  {{environmentData.companyName}}
                </span>
              </p>
            </div>
            <br>
            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  {{environmentData.companyAddress}}
                </span>
              </p>
            </div>
            <br>

            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  VAT NO:
                  {{environmentData.vatNo}}
                </span>
              </p>
            </div>
            <br>

            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  TELEPHONE:
                  {{environmentData.telephone}}
                </span>

              </p>
            </div>
            <br>

            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  {{environmentData.email}}
                </span>

              </p>
            </div>
            <br>

            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  {{environmentData.website}}
                </span>

              </p>
            </div> -->
          </div>

        </div>

        <div style="width: 45%;float: left;">
          <div style="padding:10px 5px;display: table; width: 100%;">
            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  <b>REFUND DATE:</b>
                </span>
                <!-- <p style="margin-left: 10px; float: right;">  -->
                <span style="float: right;">
                  {{SaleDetails.CreatedAt.toLocaleString()}}
                </span>
              </p>
            </div>
            <br>
            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  <b>REFUND NO:</b>
                </span>
                <span style="margin-left: 18px; float: right;">
                  {{SaleDetails.ID}}
                </span>
              </p>
            </div>
            <br>

            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  <b>ORDER NO:</b>
                </span>
                <span style="margin-left: 18px; float: right;">
                  {{SaleDetails.OriginalSaleID}}
                </span>
              </p>
            </div> 
            
            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  <b>CUSTOMER :</b>
                </span>
                <span style="margin-left: 18px; float: right;">
                  {{SaleDetails.Customer}}
                </span>
              </p>
            </div>
            <br>

            <!-- <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  <b>COMPANY :</b>
                </span>
                <span style="margin-left: 18px; float: right;">
                  {{SaleDetails.CompanyName}}
                </span>
              </p>
            </div>
            <br>
 -->
            <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  <b>PAYMENT METHOD:</b>
                </span>
                <span style="margin-left: 18px; float: right;">
                  {{SaleDetails.PaymentMode}}
                </span>
              </p>
            </div>
            <!-- <br> -->

            <!-- <div style="width: 100%;">
              <p style="font-family: Georgia, 'Times New Roman', Times, serif;font-size: 12px;margin:0;">
                <span style="float: left;">
                  <b>SHIPPING METHOD:</b>
                </span>
                <span style="margin-left: 18px; float: right;">
                 {{SaleDetails.ShippingMethod}}
                </span>
              </p>
            </div> -->
          </div>
        </div>
      </div>
    </div>

  
    <table style="width: 100%;margin-top: 10px; " cellspacing="0">
      <thead>
        <tr style="border-top:none;page-break-inside:avoid;">
          <th
            style="text-align:left;background-color: #d3d4d5;font-family: Georgia, 'Times New Roman', Times, serif; padding: 15px !important; border: 1px solid #d3d4d5; ">
            Description</th>
            <th
            style="background-color: #d3d4d5;font-family: Georgia, 'Times New Roman', Times, serif; padding: 15px !important; border: 1px solid #d3d4d5; border-left: none;">
            Model No
          </th>
          <th
            style="background-color: #d3d4d5;font-family: Georgia, 'Times New Roman', Times, serif; padding: 15px !important; border: 1px solid #d3d4d5; border-left: none;">
            Quantity
          </th>
          <th
            style="background-color: #d3d4d5;font-family: Georgia, 'Times New Roman', Times, serif; padding: 15px !important; border: 1px solid #d3d4d5; border-left: none;">
            Unit Price
          </th>
          <th
            style="background-color: #d3d4d5;font-family: Georgia, 'Times New Roman', Times, serif; padding: 15px !important; border: 1px solid #d3d4d5; border-left:none;">
            Discount
          </th>
          <th
            style="background-color: #d3d4d5;font-family: Georgia, 'Times New Roman', Times, serif; padding: 15px !important; border: 1px solid #d3d4d5; border-left:none;">
            Sub Total 
          </th>
          <th
            style="background-color: #d3d4d5;font-family: Georgia, 'Times New Roman', Times, serif; padding: 15px !important; border: 1px solid #d3d4d5; border-left:none;">
            Net Price 
          </th>
        </tr>

      </thead>
      <!-- ngFor="let item of printdata.SaleDetails; let i = index" -->
      <tr *ngFor="let product of SaleDetails.ReturnSaleDetails">

        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center; padding: 5px !important; border: 1px solid #d3d4d5;border-top: none; ">
          {{ product.ProductVariant == null || product.ProductVariant == ""|| product.ProductVariant == "N.A, N.A" || product.ProductVariant == "Color N.A, Size N.A" ? product.Product : product.Product + " (" + product.ProductVariant + ")"}}
        </td>
        <td
        style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center; padding: 5px !important; border: 1px solid #d3d4d5;border-top: none; border-left: none;">
        {{product.BLabel}}
      </td>
        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center; padding: 5px !important; border: 1px solid #d3d4d5;border-top: none; border-left: none;">
          {{product.Quantity}}
        </td>
        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center; padding: 5px !important; border: 1px solid #d3d4d5;border-top: none; border-left: none;">
          <span>€ </span> {{product.dTotalUnitValue | number:'1.2-2' }}
        </td>
        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center; padding: 5px !important; border: 1px solid #d3d4d5;border-top: none; border-left: none;">
          <span>€ </span> {{product.dTotalDiscount | number:'1.2-2' }}
        </td>
        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center; padding: 5px !important; border: 1px solid #d3d4d5;border-top: none; border-left: none;">
          <span>€ </span> {{product.dTotalValue | number:'1.2-2' }}
        </td>
        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center; padding: 5px !important; border-left:none;border: 1px solid #d3d4d5;border-top: none; border-left: none; ">
          <span>€ </span> {{(product.dTotalValue - product.dTotalDiscount) | number:'1.2-2' }}
        </td>
        
      <tr>
        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: right; padding-right: 10px;border: 1px solid #d3d4d5; padding: 5px;  border-top: none;"
          colspan="6"> <b>Subtotal</b></td>
        <td
          style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center;border-left:none;border: 1px solid #d3d4d5; padding: 5px;   border-left: none; border-top: none;"
          colspan="1">
            <span>€ </span> {{SaleDetails.txtSubTotal | number:'1.2-2' }}
        </td>
      </tr>
      <tr>
        <td
         style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: right;padding-right: 10px;border: 1px solid #d3d4d5; padding: 5px; border-top: none;"
         colspan="6"><b>Discount</b></td>
       <td
         style="font-size:13px;font-family: Georgia, 'Times New Roman', Times, serif; text-align: center;border-left:none;border: 1px solid #d3d4d5; padding: 5px; border-top: none;border-left:none;"
         colspan="1">
           <span>€ </span> {{SaleDetails.txtTotalDiscount | number:'1.2-2' }}
       </td>
     </tr>
      
      <tr>
        <td
          style="font-family: Georgia, 'Times New Roman', Times, serif; text-align: right; padding-right: 10px;border: 1px solid #d3d4d5; padding: 5px; border-top: none;"
          colspan="6"><b>Total</b></td>
        <td
          style="font-family: Georgia, 'Times New Roman', Times, serif; text-align: center;border-left:none;border: 1px solid #d3d4d5; padding: 5px; border-top: none;border-left:none;"
          colspan="1">
            <span>€ </span> {{SaleDetails.txtTotal | number:'1.2-2' }}
        </td>
      </tr>
    </table>

  </div>
</div>